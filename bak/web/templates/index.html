<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Target Web â€” Index</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <main class="container" role="main">
    <section class="card">
      <h1 class="title">Target Web</h1>
      <p class="help">Small test service for lab exercises. Pick an action below.</p>

      <div style="display:grid; gap:10px; margin-top:16px;">
        <a class="btn-link" href="{{ url_for('login_page') }}">ðŸ”’ Sign in (Login page)</a>

        <form id="echoForm" class="mini-form" onsubmit="return doEcho();">
          <label for="q">Echo (quick):</label>
          <div style="display:flex; gap:8px;">
            <input id="q" name="q" type="text" placeholder="hello world" style="flex:1" />
            <button type="submit">Echo</button>
          </div>
          <div id="echoResult" class="msg" aria-live="polite"></div>
        </form>

        <div>
          <label>Forced status:</label>
          <div style="display:flex; gap:8px; margin-top:6px;">
            <a class="btn-link" href="{{ url_for('status_code', code=200) }}">200</a>
            <a class="btn-link" href="{{ url_for('status_code', code=404) }}">404</a>
            <a class="btn-link" href="{{ url_for('status_code', code=500) }}">500</a>
          </div>
        </div>

        <div>
          <label>Admin panel (token):</label>
          <p style="margin:6px 0 0 0; color:var(--muted); font-size:13px;">Try <code>/admin?token=changeme</code> (lab token)</p>
          <a class="btn-link" href="{{ url_for('admin') }}">Open /admin</a>
        </div>

        <p class="help" style="margin-top:12px;">
          Behind the scenes this app logs events (auth attempts, admin probes, status calls) â€” check container logs or your SIEM.
        </p>
      </div>
    </section>
  </main>

  <style>
    /* small additions so the buttons & form look ok even if styles.css is minimal */
    .btn-link {
      display:inline-block;
      padding:10px 14px;
      border-radius:10px;
      text-decoration:none;
      font-weight:600;
      background:var(--accent);
      color:white;
    }
    .mini-form input[type="text"]{padding:8px;border-radius:8px;border:1px solid #e6e9ef;background:#fbfdff}
    .mini-form button{padding:8px 12px;border-radius:8px}
  </style>

  <script>
    async function doEcho(){
      const q = document.getElementById('q').value || '';
      const resEl = document.getElementById('echoResult');
      resEl.textContent = 'â€¦';
      try {
        const r = await fetch('/echo?q=' + encodeURIComponent(q));
        const data = await r.json();
        if (r.ok) {
          resEl.textContent = 'Echo: ' + (data.echo || '') + '  (hash: ' + (data.hash||'') + ')';
        } else {
          resEl.textContent = 'Error: ' + r.status;
        }
      } catch (e) {
        resEl.textContent = 'Network error';
      }
      return false; // prevent navigation
    }
  </script>
</body>
</html>
